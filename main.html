<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>COD:M — BR Caster Reference</title>
<meta name="theme-color" content="#0d1014"/>

<style>
  /* CODM palette */
  :root{
    --bg:#0d1014;
    --panel:#292d42;   /* secondary dark navy */
    --panel2:#1e2432;  /* deeper panel */
    --ink:#f3f6fa;
    --muted:#b8c0cc;
    --brand:#ffe93b;   /* primary yellow */
    --brandText:#0b0d0e;
    --brand2:#ffffff;  /* white */
    --line:#4c525d;    /* secondary gray-blue */
    --chip:#213830;    /* deep green accent */
    --good:#62e887; --bad:#ff6b6b; --warn:#ffe93b;
  }

  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif}
  a{color:var(--brand);text-decoration:none}
  a:hover{text-decoration:underline}

  header{position:sticky;top:0;z-index:20;background:linear-gradient(180deg,#141a23 0%,#0d1014 100%);border-bottom:2px solid var(--brand)}
  .head{display:flex;align-items:center;gap:14px;max-width:1200px;margin:0 auto;padding:12px 14px}
  .logo{width:40px;height:40px;border-radius:8px;object-fit:contain;flex:0 0 auto}
  h1{margin:0;font-size:1.1rem;letter-spacing:.4px;color:var(--brand)}
  .head .bar{margin-left:auto;display:flex;gap:8px;align-items:center} /* (empty now — back button removed) */
  .btn{background:var(--brand);color:var(--brandText);border:0;border-radius:10px;padding:8px 12px;font-weight:800;cursor:pointer}
  .btn.ghost{background:var(--panel2);color:var(--ink);border:1px solid var(--line)}
  .btn:disabled{opacity:.5;cursor:not-allowed}

  .shell{max-width:1200px;margin:18px auto;padding:0 12px}

  /* top tabs (pagination) */
  .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 14px}
  .tab{background:var(--panel2);border:1px solid var(--line);color:var(--ink);padding:8px 12px;border-radius:10px;cursor:pointer}
  .tab[aria-current="page"]{background:var(--brand);color:var(--brandText);border-color:var(--brand);font-weight:900}

  /* filter bar */
  .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .chip{background:var(--chip);border:1px solid var(--line);color:#d2efe1;border-radius:999px;padding:6px 10px}
  .controls input,.controls select{background:#151b26;color:var(--ink);border:1px solid var(--line);border-radius:8px;padding:8px 10px}
  .muted{color:var(--muted)}
  .hidden{display:none}

  .block{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:14px;margin-bottom:14px;box-shadow:0 0 0 1px rgba(0,0,0,.2) inset}
  .block h2{margin:0 0 8px 0;color:var(--brand2)}
  .group-head{display:flex;align-items:baseline;gap:10px;flex-wrap:wrap}

  /* ===== Classes page cards ===== */
  .grid{display:grid;grid-template-columns:1fr;gap:14px}
  @media(min-width:800px){ .grid{grid-template-columns:1fr 1fr} }
  @media(min-width:1080px){ .grid{grid-template-columns:1fr 1fr 1fr} }
  .class-card{background:var(--panel2);border:1px solid var(--line);border-radius:12px;overflow:hidden;display:flex;flex-direction:column}
  .class-card img{width:100%;aspect-ratio:16/9;object-fit:cover;background:#000}
  .class-info{padding:12px;display:flex;flex-direction:column;gap:6px}
  .title-row{display:flex;align-items:center;gap:8px}
  .title-row h3{margin:0;font-size:1.05rem}
  .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:#101621;border:1px solid var(--line);color:#e7ecf3;font-size:.75rem}
  .kv b{color:#ffffff}
  .tag{font-size:.8rem;opacity:.9;margin-left:6px}

  /* ===== Map-first layout (left mini-cards, right big map) ===== */
  .layout{display:grid;grid-template-columns:1fr;gap:14px}
  @media(min-width:900px){
    .layout{grid-template-columns:minmax(260px,340px) 1fr}
  }

  /* left column mini list */
  .side{background:var(--panel2);border:1px solid var(--line);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:10px}
  .side .controls{margin-bottom:6px}
  .mini-meta{font-size:.85rem;color:var(--muted)}

  /* 2-col mini cards with hover */
  .mini-list{
    display:grid;
    grid-template-columns:1fr;
    gap:10px;
    overflow:auto;
    max-height:calc(100dvh - 220px);
  }
  @media(min-width:900px){
    .mini-list{ grid-template-columns:1fr 1fr; position:sticky; top:88px; max-height:calc(100dvh - 110px); }
  }

  .mini-card{
    display:flex; align-items:flex-start; gap:10px;
    padding:10px; border-radius:12px;
    background:#141b27; border:1px solid var(--line);
    position:relative;
  }
  .mini-thumb{ width:84px; height:52px; border-radius:8px; object-fit:cover; background:#000; flex:0 0 auto }
  .mini-txt{display:flex;flex-direction:column;gap:2px;min-width:0}
  .mini-name{ font-size:.90rem; font-weight:800; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
  .mini-pill{ font-size:.68rem; opacity:.9; border:1px solid var(--line); border-radius:999px; padding:1px 6px; display:inline-block; width:max-content }
  .mini-desc{ display:none; font-size:.78rem; color:var(--muted); line-height:1.35; margin-top:6px; }
  .mini-card:hover .mini-desc{ display:block; }

  /* right column map */
  .map-col{background:var(--panel2);border:1px solid var(--line);border-radius:12px;padding:12px}
  .map-head{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-bottom:8px}
  .map-tabs .tab{padding:6px 10px;border-radius:999px}
  .map-wrap{border:1px solid var(--line);border-radius:12px;overflow:hidden;background:#000;display:flex;align-items:center;justify-content:center;min-height:55vh}
  @media(min-width:900px){ .map-wrap{min-height:72vh} }
  .map-wrap img{width:100%;height:100%;object-fit:cover}
  .map-notes{margin-top:10px;display:grid;gap:10px}
  .panel-list{background:var(--panel);border:1px solid var(--line);border-radius:10px;padding:10px}
  .panel-list h3{margin:0 0 6px 0;color:var(--brand2);font-size:1rem}
  .panel-list ul{margin:0;padding-left:18px;line-height:1.45}

  footer{border-top:1px solid var(--line);margin-top:18px;padding:14px 0 28px}
  footer small{color:var(--muted)}

  /* BR Systems tweaks */
  #brPanel ul{margin:0;padding-left:18px;line-height:1.5}
  #brPanel h3{margin:0 0 8px 0;color:var(--brand2)}

  /* Buy Station price table */
  .price-table{width:100%;border-collapse:collapse;font-size:.92rem}
  .price-table th,.price-table td{border:1px solid var(--line);padding:8px 10px}
  .price-table th{background:#141b27;text-align:left}
  .price-table td:nth-child(2),.price-table td:nth-child(3){text-align:right;white-space:nowrap}
  .price-note{margin-top:6px;color:var(--muted);font-size:.85rem}
</style>
</head>
<body>
<header>
  <div class="head">
    <img src="https://i.imgur.com/K0TTjUC.png" alt="Logo" class="logo">
    <h1>CODM — Battle Royale Caster Reference</h1>
    <div class="bar"><!-- back button removed --></div>
  </div>
</header>

<div class="shell">

  <!-- Pagination Tabs -->
  <div class="block">
    <div id="tabs" class="tabs"></div>
  </div>

  <!-- ===================== PAGE 1: CLASSES ===================== -->
  <section class="block page" data-title="Classes">
    <div class="group-head">
      <h2>All Operator Classes</h2>
      <span class="muted">Original grid view kept here. Use “Maps” for map-first layout.</span>
    </div>

    <div class="controls" style="margin:8px 0 12px">
      <label class="chip">Category
        <select id="fCat">
          <option value="ALL">All</option>
          <option>Disrupt</option>
          <option>Stealth</option>
          <option>Support</option>
          <option>Defense</option>
          <option>Tracker</option>
        </select>
      </label>
      <label class="chip">Search
        <input id="fSearch" type="text" placeholder="Type to filter…">
      </label>
      <span class="muted" id="metaCount">—</span>
    </div>

    <div id="classGrid" class="grid"></div>
  </section>

  <!-- ===================== PAGE 2: MAPS ===================== -->
  <section class="block page hidden" data-title="Maps">
    <h2>Maps & Areas</h2>

    <div class="layout">
      <!-- Left: Compact cards -->
      <aside class="side">
        <div class="controls">
          <label class="chip">Category
            <select id="mCat">
              <option value="ALL">All</option>
              <option>Disrupt</option>
              <option>Stealth</option>
              <option>Support</option>
              <option>Defense</option>
              <option>Tracker</option>
            </select>
          </label>
          <label class="chip">Search
            <input id="mSearch" type="text" placeholder="Type to filter…">
          </label>
        </div>
        <div class="mini-meta" id="miniMeta">—</div>
        <div id="miniList" class="mini-list"></div>
      </aside>

      <!-- Right: Big map -->
      <section class="map-col">
        <div class="map-head">
          <div class="map-tabs tabs" id="mapTabs"></div>
          <span class="muted">Tip: keep the mini cards on the left for quick callouts.</span>
        </div>

        <div class="map-wrap">
          <img id="mapImage" alt="Map View" src="https://i.imgur.com/zhCe95I.png">
        </div>

        <div class="map-notes" id="mapNotes"><!-- filled by JS --></div>
      </section>
    </div>
  </section>

  <!-- ===================== PAGE 3: OTHER DETAILS ===================== -->
  <section class="block page hidden" data-title="Other Details">
    <h2>Other Details</h2>
    <div class="layout">
      <div class="panel-list">
        <h3>Ammo & Weapons (quick)</h3>
        <ul>
          <li><b>Ammo types:</b> Light • Heavy • Sniper • Shotgun • Rockets.</li>
          <li><b>Ground loot:</b> common → rare → epic → legendary. Airdrops grant stronger variants & mod slots.</li>
          <li><b>Attachment mods:</b> Extended, Long Barrel, Stabilizer, OWC Laser, Tactical Scope, etc. Legendary mods stack power spikes — note when a team loots an airdrop.</li>
        </ul>
        <h3 style="margin-top:10px">Throwables</h3>
        <ul>
          <li>Frag, Sticky, Molotov, Cluster, Concussion, Flash, Smoke.</li>
          <li>Trip Mines & Trophy Systems appear as ground loot or class skills.</li>
        </ul>
      </div>

      <div class="panel-list">
        <h3>Vehicles</h3>
        <ul>
          <li>ATV • Motorcycle • SUV • Cargo Truck • Helicopter • Boat (map dependent).</li>
          <li>Heli control = priority info. Call armor/HP and fuel when teams rotate.</li>
        </ul>
        <h3 style="margin-top:10px">Caster Reminders</h3>
        <ul>
          <li>Track <b>class synergies</b> (e.g., Refitter + Defender; Ninja entry on 3rd party).</li>
          <li>Note <b>revive coin & chip</b> timings; highlight squads hitting class chip stations.</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- ===================== PAGE 4: BR SYSTEMS (BUY STATION + GULAG) ===================== -->
  <section class="block page hidden" data-title="BR Systems">
    <h2>BR Systems — Buy Station & Gulag</h2>

    <div class="layout">
      <!-- Left: compact reference -->
      <aside class="side">
        <div class="controls">
          <span class="chip">Quick Reference</span>
        </div>

        <!-- Buy Station mini card -->
        <div class="mini-card">
          <img class="mini-thumb" src="https://i.imgur.com/w3xxuAT.jpeg" alt="Isolated">
          <div class="mini-txt">
            <div class="mini-name">Buy Stations</div>
            <span class="mini-pill">Season 5 (LT) — Isolated</span>
          </div>
        </div>
        <ul class="mini-meta" style="line-height:1.5;margin:0 0 8px 0;padding-left:16px">
          <li>Loot <b>Cash</b> on ground & from eliminations.</li>
          <li>Spend at Buy Stations for <b>Perks</b>, <b>Scorestreaks</b>, <b>weapons</b>, <b>armor/ammo refills</b>, and special items.</li>
          <li>Eliminated players <b>drop Cash</b> — third-party & scoop.</li>
        </ul>

        <!-- Gulag mini card -->
        <div class="mini-card">
          <img class="mini-thumb" src="https://i.imgur.com/8S1A7ml.jpeg" alt="Isolated">
          <div class="mini-txt">
            <div class="mini-name">Gulag</div>
            <span class="mini-pill">Season 7 (LT) — Isolated</span>
          </div>
        </div>
        <ul class="mini-meta" style="line-height:1.5;margin:0 0 8px 0;padding-left:16px">
          <li>Upon first death: go to <b>1v1 Gulag</b>.</li>
          <li><b>Win</b> to redeploy. <b>Lose</b> and teammates can <b>buy your tag</b> at a Buy Station.</li>
          <li>Everyone gets <b>1 free attempt</b>; extra attempts need <b>Gulag Ticket</b> from a Buy Station.</li>
        </ul>
      </aside>

      <!-- Right: big panel with details -->
      <section class="map-col">
        <div class="map-head">
          <div class="tabs">
            <button class="tab" aria-current="page" onclick="setBRPanel('buy')">Buy Station</button>
            <button class="tab" onclick="setBRPanel('gulag')">Gulag</button>
          </div>
          <span class="muted">Use this as on-desk cheat-sheet while casting.</span>
        </div>

        <div id="brPanel" class="panel-list"><!-- Filled by JS --></div>
        <!-- Price table container -->
        <div id="buyPrices" class="panel-list"></div>

        <div class="map-notes">
          <div class="panel-list">
            <h3>Caster Callouts</h3>
            <ul>
              <li><b>Economy swing:</b> Mention Cash thresholds before late-zone pushes.</li>
              <li><b>Shop risk:</b> “They’re shopping exposed”—build tension on 3rd-party angles.</li>
              <li><b>Gulag state:</b> Track who still has <i>free attempt</i> / <i>Ticket</i> and who requires buyback.</li>
            </ul>
          </div>
        </div>
      </section>
    </div>
  </section>

  <footer class="shell">
    <small>Created by Neptune Garcia</small>
  </footer>
</div>

<script>
  /* ---------- Top pagination ---------- */
  const pages = Array.from(document.querySelectorAll('.page'));
  const tabs  = document.getElementById('tabs');
  pages.forEach((sec,i)=>{
    const b = document.createElement('button');
    b.className='tab'; b.textContent = sec.dataset.title || `Page ${i+1}`;
    b.addEventListener('click', ()=> go(i));
    tabs.appendChild(b);
  });
  function go(n){
    const idx = Math.max(0, Math.min(pages.length-1, n));
    pages.forEach((p,i)=> p.classList.toggle('hidden', i!==idx));
    Array.from(tabs.children).forEach((t,i)=> t.setAttribute('aria-current', i===idx ? 'page' : 'false'));
    window.scrollTo({top:0, behavior:'smooth'});
    sessionStorage.setItem('codm_ref_tab', String(idx));
  }

  /* ---------- Class data ---------- */
  const CLASSES = [
    // DISRUPT
    {name:'Smoke Bomber', cat:'Disrupt', img:'https://i.imgur.com/5Von4HS.jpeg',
      skill:'Cluster Smoke Grenade — generates smoke in a target area that can mark enemies.',
      passive:'After activating skill, movement speed is increased.'},
    {name:'Trap Master', cat:'Disrupt', img:'https://i.imgur.com/Ix22OZX.jpeg',
      skill:'Electric Trip Wire — slows enemies and deals damage to those inside.',
      passive:'After activating skill, movement speed is increased.'},
    {name:'Misdirection', cat:'Disrupt', img:'https://i.imgur.com/mHyxMFJ.jpeg',
      skill:'Misdirection Device — hides the user’s sound and creates fake noise sources.',
      passive:'After activating skill, movement speed is increased.'},
    {name:'Trickster', cat:'Disrupt', img:'https://i.imgur.com/Juck3s7.jpeg',
      skill:'Psychosis — deploy two holographic decoys and gain a strong speed boost.',
      passive:'After activating skill, movement speed is increased.'},
    {name:'Hacker', cat:'Disrupt', img:'https://i.imgur.com/ambedR9.jpeg',
      skill:'Ice Pick — disrupts enemy minimaps and blocks gadget use nearby.',
      passive:'Immune to Hacker; speed increases after activation.'},
    {name:'Rewind', cat:'Disrupt', img:'https://i.imgur.com/FHZ6CLB.jpeg',
      skill:'Glitch — teleport back to your position from 6 seconds prior.',
      passive:'After activating skill, movement speed is increased.'},
    {name:'Shock Wave', cat:'Disrupt', img:'https://i.imgur.com/TzrZLou.jpeg',
      skill:'Shock Wave — pushes & damages hostiles; briefly blocks incoming projectiles.',
      passive:'After activating skill, movement speed is increased.'},

    // STEALTH
    {name:'Ninja', cat:'Stealth', img:'https://i.imgur.com/vaEUwwT.jpeg',
      skill:'Grapple Hook — pull yourself to the target for fast entries.',
      passive:'Reduces movement noises.'},
    {name:'Poltergeist', cat:'Stealth', img:'https://i.imgur.com/ZkEbHl8.jpeg',
      skill:'Active Camo — near-invisibility for a short duration.',
      passive:'Reduces movement noises.'},
    {name:'Pumped', cat:'Stealth', img:'https://i.imgur.com/v2JPRnv.jpeg',
      skill:'Power Jump — enhanced jumping and extra nitrogen after activation.',
      passive:'Reduces movement noises.'},
    {name:'Quick Strike', cat:'Stealth', img:'https://i.imgur.com/gstrWOn.jpeg',
      skill:'Quick Strike — block front bullets then slash to damage enemies.',
      passive:'Reduces movement noises.'},
    {name:'Jet Boost', cat:'Stealth', img:'https://i.imgur.com/07c8Hol.jpeg',
      skill:'Jet Boost — wall run, jet-jump, and jet-slide while active.',
      passive:'Reduces movement noises.'},
    {name:'Teleporter', cat:'Stealth', img:'https://i.imgur.com/EbrxsOE.jpeg',
      skill:'Teleporter Beacon — multiple teleports; entering combat interrupts.',
      passive:'Reduces movement noises.'},
    {name:'Tactical Bouncer', cat:'Stealth', img:'https://i.imgur.com/0NlWFbq.jpeg',
      skill:'Bouncer Platform — catapults players, vehicles & throwables upward.',
      passive:'Reduces movement noises.'},

    // SUPPORT
    {name:'Medic', cat:'Support', img:'https://i.imgur.com/DmHFyUj.jpeg',
      skill:'Medical Station — heals you and allies continuously.',
      passive:'Reduces recovery time.'},
    {name:'Refitter', cat:'Support', img:'https://i.imgur.com/7Cgp0VH.jpeg',
      skill:'Armor Pack — drop repair packs for the team. Auto-repairs the vehicle you ride.',
      passive:'Reduces recovery time.'},
    {name:'Kinetic Station', cat:'Support', img:'https://i.imgur.com/cYlgKyf.jpeg',
      skill:'Kinetic Station — deploy for limited-time armor to reduce bullet damage.',
      passive:'Reduces recovery time.'},
    {name:'Revive', cat:'Support', img:'https://i.imgur.com/bCD2vk4.jpeg',
      skill:'Revive Drone — searches for and revives teammates automatically.',
      passive:'Reduces recovery time.'},

    // DEFENSE
    {name:'Defender', cat:'Defense', img:'https://i.imgur.com/78iMmlU.jpeg',
      skill:'Transform Shield — deploy cover that flashbangs nearby hostiles.',
      passive:'Reduces explosive damage and negative statuses.'},
    {name:'Desperado', cat:'Defense', img:'https://i.imgur.com/8hTuwnZ.jpeg',
      skill:'Shield Turret — place a shielded turret. When downed, fight with pistol; kills revive you.',
      passive:'Reduces explosive damage and negative statuses.'},
    {name:'Spotter', cat:'Defense', img:'https://i.imgur.com/EbF3a3R.jpeg',
      skill:'Cluster Strike — call an air strike on a designated area.',
      passive:'Reduces explosive damage and negative statuses.'},
    {name:'Igniter', cat:'Defense', img:'https://i.imgur.com/JcRNvAM.jpeg',
      skill:'Tinder Bag — continuously spews tar to control space.',
      passive:'Reduces explosive damage and negative statuses.'},

    // TRACKER
    {name:'Scout', cat:'Tracker', img:'https://i.imgur.com/3i9SxOc.jpeg',
      skill:'Sensor Dart — reveals hostiles on radar.',
      passive:'Enemy footprints visible; footsteps audible from distance.'},
    {name:'Clown', cat:'Tracker', img:'https://i.imgur.com/abSMexk.jpeg',
      skill:'Toy Bomb — summon dogs that attack nearby enemies.',
      passive:'Enemy footsteps can be heard from a distance.'},
    {name:'Mechanic', cat:'Tracker', img:'https://i.imgur.com/CrlOFGM.jpeg',
      skill:'EMP Drone — interferes with hostiles.',
      passive:'Detect vehicles through walls; footsteps audible from distance.'},
    {name:'Airborne', cat:'Tracker', img:'https://i.imgur.com/ElXS8sq.jpeg',
      skill:'Ejection Device — catapult team into the air, trigger wingsuit.',
      passive:'Gliding lasts longer; footsteps audible from distance.'},
    {name:'Ravager Launcher', cat:'Tracker', img:'https://i.imgur.com/5FUvd6c.jpeg',
      skill:'Ravager Launcher — locks onto enemy soldiers & vehicles automatically.',
      passive:'Enemy footsteps can be heard from a distance.'}
  ];

  // --- Buy Station prices (Normal & Fire Sale = 30% off) ---
  const BUY_PRICES = [
    {item:"Heavy Ammo",     normal:1000},
    {item:"Sniper Ammo",    normal:1000},
    {item:"Light Ammo",     normal:1000},
    {item:"Shotgun Ammo",   normal:1000},
    {item:"Rockets",        normal:1000},

    {item:"Ballistic Expert",   normal:4000},
    {item:"Self Revive Kit",    normal:6000},
    {item:"Backpack Lv.3",      normal:12000},
    {item:"Backpack Lv.2",      normal:5000},

    {item:"Level 1 Armor",      normal:3000},
    {item:"Advanced Armor",     normal:3000},
    {item:"Kinetic Armor",      normal:5000},
    {item:"Thermite",           normal:3000},
    {item:"C4",                 normal:3000},
    {item:"Trophy System",      normal:3000},

    {item:"Chip Upgrade",       normal:5000},
    {item:"Revival Coin",       normal:15000},

    {item:"Loadout Drop",       normal:50000},
    {item:"Mini Loadout Drop",  normal:20000},
    {item:"Mythic Weapon",      normal:12000},

    {item:"Stealth Chopper",    normal:15000},
    {item:"Strafe Run",         normal:8000},
    {item:"RC XD",              normal:8000},

    {item:"Legendary Mods",     normal:7000},
    {item:"Purple Mods",        normal:5000},
    {item:"Blue Mods",          normal:3000},

    {item:"Normal BR Tank",     normal:30000},
    {item:"Shrike AAV Tank",    normal:30000},
    {item:"New Armored Vehicle",normal:30000},
  ];
  const fmt = n => n>=1000 ? ((n%1000===0? (n/1000): (n/1000).toFixed(1)) + "K") : String(n);
  const sale = n => Math.round(n * 0.7);

  function renderBuyPrices(){
    const host = document.getElementById('buyPrices');
    if(!host) return;
    const rows = BUY_PRICES.map(r=>`
      <tr>
        <td>${r.item}</td>
        <td>C ${fmt(r.normal)}</td>
        <td>C ${fmt(sale(r.normal))}</td>
      </tr>`).join('');
    host.innerHTML = `
      <h3>Buy Station Prices</h3>
      <table class="price-table">
        <thead>
          <tr><th>Item</th><th>Normal</th><th>Fire&nbsp;Sale</th></tr>
        </thead>
        <tbody>${rows}</tbody>
      </table>
      <div class="price-note">Fire Sale applies a 30% discount to all Buy Station items. Prices can vary by mode/region and may be tuned in future updates.</div>
    `;
  }

  // Simple content model for BR Systems
  const BR_INFO = {
    buy: {
      title: "Buy Station — How It Works",
      points: [
        "<b>Where:</b> Spawns on <i>Isolated</i> (LT event in S5).",
        "<b>Cash:</b> Looted on ground and from eliminations; dropped on death.",
        "<b>What to buy:</b> Weapons, <i>Perks</i>, <i>Scorestreaks</i>, armor/ammo refills, special items (e.g., Purifier).",
        "<b>Rotation timing:</b> Shop fast—exposure invites third parties."
      ],
      tips: [
        "Ping Cash and share before committing to a push.",
        "Announce team economy (\"two streaks online, refills secured\").",
        "If a teammate is down, prioritize Cash for a potential buyback flow in S7."
      ]
    },
    gulag: {
      title: "Gulag — Flow",
      points: [
        "<b>Trigger:</b> First elimination sends you to a <b>1v1</b> Gulag.",
        "<b>Win:</b> Immediate redeploy.",
        "<b>Lose:</b> Spectate until a teammate <b>buys your dog tag</b> at a Buy Station.",
        "<b>Attempts:</b> Everyone has <b>1 free</b>; extra via <b>Gulag Ticket</b> (purchased at Buy Station)."
      ],
      tips: [
        "Track who still has a free attempt vs. who needs a Ticket.",
        "If two teammates are queued for Gulag, call potential staggered redeploys.",
        "Remind viewers when a squad spends for buyback—economy pressure affects late zones."
      ]
    }
  };

  function setBRPanel(which){
    const data = BR_INFO[which] || BR_INFO.buy;
    const box = document.getElementById('brPanel');
    box.innerHTML = `
      <h3>${data.title}</h3>
      <ul>${data.points.map(p=>`<li>${p}</li>`).join('')}</ul>
      <h3 style="margin-top:10px">Desk Tips</h3>
      <ul>${data.tips.map(p=>`<li>${p}</li>`).join('')}</ul>
    `;
    const btns = box.parentElement.querySelectorAll('.tabs .tab');
    btns.forEach(b=>b.setAttribute('aria-current', b.textContent.toLowerCase().includes(which) ? 'page':'false'));
    sessionStorage.setItem('codm_br_panel', which);

    // render price table when Buy Station tab is active
    const pricesPanel = document.getElementById('buyPrices');
    pricesPanel.style.display = (which==='buy') ? 'block' : 'none';
    if(which==='buy') renderBuyPrices();
  }

  // init default panel on load of this page
  (function(){
    const saved = sessionStorage.getItem('codm_br_panel') || 'buy';
    if (document.querySelector('[data-title="BR Systems"]') && !document.querySelector('[data-title="BR Systems"]').classList.contains('hidden')) {
      setBRPanel(saved);
    }
    // Hook into tab navigation
    const origGo = window.go;
    window.go = function(n){
      origGo(n);
      const pages = Array.from(document.querySelectorAll('.page'));
      const idx = Math.max(0, Math.min(pages.length-1, n));
      if (pages[idx].dataset.title === 'BR Systems') setBRPanel(sessionStorage.getItem('codm_br_panel') || 'buy');
    };
  })();

  /* ---------- Classes page rendering ---------- */
  const grid = document.getElementById('classGrid');
  const fCat = document.getElementById('fCat');
  const fSearch = document.getElementById('fSearch');
  const meta = document.getElementById('metaCount');

  function renderClasses(){
    const cat = fCat.value || 'ALL';
    const q = (fSearch?.value||'').trim().toLowerCase();
    const rows = CLASSES.filter(c =>
      (cat==='ALL' || c.cat===cat) &&
      (!q || (c.name.toLowerCase().includes(q) || c.cat.toLowerCase().includes(q) ||
              c.skill.toLowerCase().includes(q) || (c.passive||'').toLowerCase().includes(q)))
    );
    grid.innerHTML = '';
    rows.forEach(c=>{
      const card = document.createElement('article');
      card.className = 'class-card';
      card.innerHTML = `
        <img src="${c.img}" alt="${c.name}">
        <div class="class-info">
          <div class="title-row">
            <h3>${c.name}</h3>
            <span class="pill">${c.cat}</span>
          </div>
          <div class="kv"><b>Skill:</b> ${c.skill}</div>
          ${c.passive ? `<div class="kv"><b>Passive:</b> ${c.passive}</div>`:''}
        </div>`;
      grid.appendChild(card);
    });
    meta.textContent = `${rows.length} shown • ${CLASSES.length} total`;
  }
  fCat.addEventListener('change', renderClasses);
  fSearch.addEventListener('input', renderClasses);

  /* ---------- Maps page: mini list + big map ---------- */
  const miniList = document.getElementById('miniList');
  const mCat = document.getElementById('mCat');
  const mSearch = document.getElementById('mSearch');
  const miniMeta = document.getElementById('miniMeta');

  function renderMini(){
    const cat = mCat.value || 'ALL';
    const q = (mSearch?.value||'').trim().toLowerCase();

    const rows = CLASSES.filter(c =>
      (cat==='ALL' || c.cat===cat) &&
      (!q || c.name.toLowerCase().includes(q) ||
             c.cat.toLowerCase().includes(q) ||
             c.skill.toLowerCase().includes(q) ||
            (c.passive||'').toLowerCase().includes(q))
    );

    miniList.innerHTML = '';
    rows.forEach(c=>{
      const li = document.createElement('div');
      li.className = 'mini-card';
      li.innerHTML = `
        <img class="mini-thumb" src="${c.img}" alt="${c.name}">
        <div class="mini-txt" style="min-width:0">
          <div class="mini-name">${c.name}</div>
          <span class="mini-pill">${c.cat}</span>
          <div class="mini-desc">
            <b>Skill:</b> ${c.skill}
            ${c.passive ? `<br><b>Passive:</b> ${c.passive}` : ''}
          </div>
        </div>`;
      miniList.appendChild(li);
    });

    miniMeta.textContent = `${rows.length} classes • hover for details`;
  }

  mCat.addEventListener('change', renderMini);
  mSearch.addEventListener('input', renderMini);

  /* ---------- Map viewer ---------- */
  const MAPS = {
    Isolated: {
      img: 'https://i.imgur.com/zhCe95I.png',
      notes: [
        {title:'Isolated — POIs', items:[
          'Bus Station • Killhouse • Standoff • Sakura • Estate',
          'Pipeline • Nuclear Plant • Launch Base • Crash',
          'Downtown • Harbor • Countdown • Black Market',
          'Farm • Sanitarium • Dock • Heat • Outpost',
          'High-Tier Zones rotate each match (gold beacons).'
        ]},
        {title:'Caster Notes', items:[
          '<b>North rotations:</b> Pipeline → Nuclear Plant → Launch Base ridge.',
          '<b>Hot early drops:</b> Black Market, Launch Base, Nuketown Shipyard Dock.',
          '<b>Vehicle paths:</b> ring roads around Sakura & Nuclear Plant for quick wraps.'
        ]}
      ]
    },
    Blackout: {
      img: 'https://i.imgur.com/XzkG6cV.png',
      notes: [
        {title:'Blackout — POIs', items:[
          'Estates • Construction Site • Asylum • Array • Hydro Dam',
          'Fracking Tower • Train Station • Rivertown • Factory',
          'Cargo Docks • Lighthouse • Nuketown Island • Turbine'
        ]},
        {title:'Caster Notes', items:[
          '<b>Long rotates:</b> Lighthouse ↔ Cargo Docks shore road, watch third parties.',
          '<b>Top control:</b> Construction Site cranes, Fracking tower decks.',
          '<b>Bridge fights:</b> Rivertown & Nuketown causeway — call team splits early.'
        ]}
      ]
    }
  };

  const mapTabs = document.getElementById('mapTabs');
  const mapImage = document.getElementById('mapImage');
  const mapNotes = document.getElementById('mapNotes');

  ['Isolated','Blackout'].forEach((name,i)=>{
    const b = document.createElement('button');
    b.className = 'tab';
    b.textContent = name;
    b.addEventListener('click', ()=> setMap(name));
    if(i===0) b.setAttribute('aria-current','page');
    mapTabs.appendChild(b);
  });

  function setMap(name){
    const data = MAPS[name];
    if(!data) return;
    mapImage.src = data.img;
    Array.from(mapTabs.children).forEach(btn=>{
      btn.setAttribute('aria-current', btn.textContent===name ? 'page' : 'false');
    });
    // notes
    mapNotes.innerHTML = '';
    data.notes.forEach(n=>{
      const wrap = document.createElement('div');
      wrap.className = 'panel-list';
      wrap.innerHTML = `<h3>${n.title}</h3>`;
      const ul = document.createElement('ul');
      n.items.forEach(item=>{
        const li = document.createElement('li');
        li.innerHTML = item;
        ul.appendChild(li);
      });
      wrap.appendChild(ul);
      mapNotes.appendChild(wrap);
    });
    sessionStorage.setItem('codm_map', name);
  }

  // init tab + views
  const last = parseInt(sessionStorage.getItem('codm_ref_tab')||'0',10);
  go(isFinite(last)? last : 0);
  renderClasses();
  renderMini();
  const lastMap = sessionStorage.getItem('codm_map') || 'Isolated';
  setMap(lastMap);
</script>
</body>
</html>
